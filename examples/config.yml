# ProfileMesh Configuration Example
# This is a sample configuration for profiling PostgreSQL tables

environment: development

# Source database connection
source:
  type: postgres
  host: localhost
  port: 5433
  database: profilemesh
  username: profilemesh
  password: profilemesh
  schema: public

# Storage configuration (where to save profiling results)
storage:
  connection:
    type: postgres
    host: localhost
    port: 5433
    database: profilemesh
    username: profilemesh
    password: profilemesh
    schema: public
  results_table: profilemesh_results
  runs_table: profilemesh_runs
  create_tables: true

# Profiling configuration
profiling:
  # Tables to profile
  tables:
    # Full table profiling (no partition or sampling)
    - table: customers
      schema: public
    
    # Full table profiling
    - table: products
      schema: public
    
    # Example with partition-aware profiling (commented out)
    - table: orders
      schema: public
      # Uncomment to enable partition-aware profiling:
      # partition:
      #   key: order_date              # Partition column
      #   strategy: latest             # Options: latest | recent_n | sample | all
      #   metadata_fallback: true      # Try to infer partition key if not specified
      
      # Uncomment to enable sampling:
      # sampling:
      #   enabled: true
      #   method: random               # Options: random | stratified | topk
      #   fraction: 0.01               # Sample 1% of rows
      #   max_rows: 500000             # Cap at 500k rows
  
  # Maximum distinct values to compute
  max_distinct_values: 1000
  
  # Whether to compute histograms
  compute_histograms: true
  
  # Number of histogram bins
  histogram_bins: 10
  
  # Metrics to compute
  metrics:
    - count
    - null_count
    - null_percent
    - distinct_count
    - distinct_percent
    - min
    - max
    - mean
    - stddev
    - histogram

# Drift detection configuration
drift_detection:
  # Strategy to use: "absolute_threshold", "standard_deviation", "ml_based"
  strategy: absolute_threshold
  
  # Parameters for absolute_threshold strategy
  absolute_threshold:
    low_threshold: 5.0      # 5% change triggers low severity
    medium_threshold: 15.0   # 15% change triggers medium severity
    high_threshold: 30.0     # 30% change triggers high severity
  
  # Parameters for standard_deviation strategy (alternative)
  # standard_deviation:
  #   low_threshold: 1.0     # 1 std dev triggers low severity
  #   medium_threshold: 2.0  # 2 std devs trigger medium severity
  #   high_threshold: 3.0    # 3 std devs trigger high severity
  
  # Parameters for ML-based strategy (placeholder for future)
  # ml_based:
  #   model_type: isolation_forest
  #   sensitivity: 0.8

# Event hooks configuration
hooks:
  # Master switch - set to false to disable all hooks
  enabled: true
  
  hooks:
    # Example 1: Logging hook (useful for development)
    - type: logging
      enabled: true
      log_level: INFO
    
    # Example 2: SQL event persistence (commented out)
    # - type: sql
    #   enabled: true
    #   table_name: profilemesh_events
    #   connection:
    #     type: postgres
    #     host: localhost
    #     port: 5432
    #     database: profilemesh
    #     username: profilemesh
    #     password: profilemesh
    
    # Example 3: Snowflake event persistence (commented out)
    # - type: snowflake
    #   enabled: true
    #   table_name: profilemesh_events
    #   connection:
    #     type: snowflake
    #     account: myaccount
    #     database: monitoring
    #     warehouse: compute_wh
    #     username: user
    #     password: pass
    
    # Example 4: Custom hook (commented out)
    # - type: custom
    #   enabled: true
    #   module: my_custom_hooks
    #   class_name: SlackAlertHook
    #   params:
    #     webhook_url: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
    #     channel: "#data-alerts"

